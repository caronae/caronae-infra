#!/bin/sh
set -euf -o pipefail

terraform validate

files=$(git diff --cached --name-only)
for f in $files
do
  if [ -e "$f" ] && [[ $f == *.tf ]]; then
    terraform fmt $f
    git add $f
  fi
done
